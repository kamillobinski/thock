#!/bin/bash

PIPE="$HOME/Library/Application Support/thock/thock.pipe"

if [[ ! -p "$PIPE" ]]; then
  echo "Error: Thock pipe not found at: $PIPE"
  echo "Make sure Thock is running and has created the named pipe."
  exit 1
fi

# Build the command by wrapping all args in double quotes
COMMAND=""
for arg in "$@"; do
  # Escape any embedded double quotes inside the arg
  escaped_arg="${arg//\"/\\\"}"
  COMMAND+="\"$escaped_arg\" "
done

# Trim trailing space
COMMAND="${COMMAND%% }"

echo "$COMMAND" > "$PIPE"
